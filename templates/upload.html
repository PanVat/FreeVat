{% extends "base/base.html" %}

<!-- Načtení potřebných knihoven -->
{% load crispy_forms_tags static i18n %}

<!-- Titulek stránky !-->
{% block title %} {% trans 'Upload' %} {% endblock %}

{% block content %}
    <!-- Stránka pro nahrání dat o 3D modelu -->
    <div class="form-page">
        <!-- Uploadovací formulář - kontejner -->
        <div class="form-container--upload">
            <!-- Hlavička -->
            <div>
                <h2 class="form-main-heading">
                    {% trans "Upload 3D model" %}
                </h2>
                <p class="form-sub-heading">
                    {% trans "View your uploaded models " %}
                    <a href="#">
                        {% trans 'here' %}
                    </a>
                </p>
            </div>

            <form class="mt-8 space-y-6" method="POST">
                {% csrf_token %}

                <!-- Zobrazení chybových hlášek -->
                {% include "base/error.html" %}

                <!-- Formulářová pole -->
                <div class="form-inputs-container">

                    <!-- Název -->
                    <div class="mb-4">
                        {{ form.model_name | as_crispy_field }}
                    </div>

                    <!-- Kategorie -->
                    <div class="mb-4">
                        {{ form.category | as_crispy_field }}
                    </div>

                    <!-- Popis -->
                    <div class="mb-4">
                        {{ form.description | as_crispy_field }}
                    </div>

                    <!-- Vyhledávací štítky -->
                    <div class="mb-4">
                        {{ form.tags | as_crispy_field }}
                    </div>

                    <!-- Výběr 3D modelu -->
                    <div class="file-upload-area" id="modelFileUploadArea">
                        <h3 class="text-xl font-semibold text-gray-200 mb-3">Upload 3D Model File *</h3>
                        <p class="text-gray-400 mb-6">Max File Size - 100 MB (.fbx, .gltf, .blend...)</p>

                        <!-- Tlačítko pro výběr (původní stav) -->
                        <div id="modelFileButtonContainer">
                            <input type="file" id="modelFile" name="model_file" class="file-input hidden"
                                   accept=".obj,.fbx,.stl,.gltf,.glb,.usdz,.blend,.c4d,.max,.3ds,.mb,.ma" required>
                            <label for="modelFile" class="form-file-button">
                                {% trans 'Select' %}
                            </label>
                        </div>

                        <!-- Kontejner pro zobrazení vybraného souboru (skrytý na začátku) -->
                        <div class="selected-file-container hidden mt-4" id="selectedModelContainer">
                            <div class="flex items-center justify-between">
                                <div>
                                    <span class="text-gray-300">Selected file:</span>
                                    <span id="modelFileName" class="text-teal-400 font-medium ml-2"></span>
                                </div>
                                <!-- Tlačítko pro odebrání souboru -->
                                <button type="button" id="removeModelButton" class="remove-file-button">
                                    {% trans 'Delete' %}
                                </button>
                            </div>
                        </div>

                        {% if form.model_file.errors %}
                            <div class="mt-4 p-2 bg-red-900/30 rounded text-red-400 text-sm">
                                {{ form.model_file.errors.0 }}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Výběr náhledového obrázku -->
                    <div class="file-upload-area" id="previewFileUploadArea">
                        <h3 class="text-xl font-semibold text-gray-200 mb-3">Preview Image</h3>
                        <p class="text-gray-400 mb-6">Max File Size - 2 MB (.jpg, .png...)</p>

                        <!-- Tlačítko pro výběr (původní stav) -->
                        <div id="previewFileButtonContainer">
                            <input type="file" id="previewFile" name="preview_image" class="file-input hidden"
                                   accept=".jpg,.jpeg,.png,.webp">
                            <label for="previewFile" class="form-file-button">
                                {% trans 'Select' %}
                            </label>
                        </div>

                        <!-- Kontejner pro zobrazení vybraného souboru (skrytý na začátku) -->
                        <div class="selected-file-container hidden mt-4" id="selectedPreviewContainer">
                            <div class="flex items-center justify-between mb-3">
                                <div>
                                    <span class="text-gray-300">Selected file:</span>
                                    <span id="previewFileName" class="text-blue-400 font-medium ml-2"></span>
                                </div>
                                <!-- Tlačítko pro odebrání souboru -->
                                <button type="button" id="removePreviewButton" class="remove-file-button">
                                    {% trans 'Delete' %}
                                </button>
                            </div>

                            <!-- Náhled obrázku -->
                            <div id="imagePreviewContainer" class="mt-3">
                                <div class="relative bg-gray-900 rounded-lg overflow-hidden h-48">
                                    <img id="imagePreview" src="" alt="Preview" class="w-full h-full object-cover">
                                </div>
                            </div>
                        </div>

                        {% if form.preview_image.errors %}
                            <div class="mt-4 p-2 bg-red-900/30 rounded text-red-400 text-sm">
                                {{ form.preview_image.errors.0 }}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Tlačítka -->
                <div class="flex justify-center">
                    <!-- Odeslat formulář -->
                    <button type="submit"
                            class="form-submit-button group">
                        {% trans 'Login to account' %}
                    </button>
                    <!-- Resetovat formulář -->
                    <button type="reset"
                            class="form-reset-button group">
                        Reset Form
                    </button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}