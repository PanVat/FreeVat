{% extends "base/base.html" %}
<!-- Načtení potřebných knihoven -->
{% load i18n static %}

{% block content %}
    <!-- Celá stránka s modely -->
    <div class="models-full-page">
        <!-- Nadpis a řazení modelů podle různých kritérií -->
        <div class="flex px-4 flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4">

            <!-- Nadpis kategorie nebo všechny modely -->
            <h1 class="models-category-title">
                {% if current_category %}
                    {{ current_category.name }}
                {% else %}
                    {% trans "All models" %}
                {% endif %}
            </h1>

            <!-- Dropdown pro řazení modelů -->
            <div class="relative px-4 group z-20">
                <button class="flex items-center gap-2 bg-[#1A1D1E] hover:bg-gray-800 text-white px-4 py-2 rounded-lg border border-gray-700 transition-colors text-sm font-medium">
                    <i class="fas fa-sort-amount-down text-gray-400"></i>
                    <span>
                {% if current_sort == 'newest' %}{% trans "Newest" %}
                    {% elif current_sort == 'oldest' %}{% trans "Oldest" %}
                    {% elif current_sort == 'name_asc' %}{% trans "Name (A-Z)" %}
                    {% elif current_sort == 'name_desc' %}{% trans "Name (Z-A)" %}
                {% else %}{% trans "Sort by" %}{% endif %}
            </span>
                    <i class="fas fa-chevron-down text-xs ml-2 text-gray-500 group-hover:text-white transition-colors"></i>
                </button>

                <div class="absolute right-0 mt-2 w-48 bg-[#1A1D1E] border border-gray-700 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-right">
                    <div class="py-1">
                        <a href="?sort=newest"
                           class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white {% if current_sort == 'newest' %}bg-gray-800 text-white font-bold{% endif %}">
                            {% trans "Newest" %}
                        </a>

                        <a href="?sort=oldest"
                           class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white {% if current_sort == 'oldest' %}bg-gray-800 text-white font-bold{% endif %}">
                            {% trans "Oldest" %}
                        </a>

                        <a href="?sort=name_asc"
                           class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white {% if current_sort == 'name_asc' %}bg-gray-800 text-white font-bold{% endif %}">
                            {% trans "Name (A-Z)" %}
                        </a>

                        <a href="?sort=name_desc"
                           class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white {% if current_sort == 'name_desc' %}bg-gray-800 text-white font-bold{% endif %}">
                            {% trans "Name (Z-A)" %}
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Náhledové okno s 3D modelem, po kliknutí se zobrazí podrobnosti o daném modelu -->
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
            {% for model in models %}
                <a href="{% url 'model_detail' model.pk %}" class="group block">
                    <div class="bg-[#1A1D1E] rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 border border-gray-800">

                        <div class="aspect-video bg-gray-900 relative overflow-hidden w-full">
                            {% if model.thumbnail %}
                                <img src="{{ model.thumbnail.url }}" alt="{{ model.name }}"
                                     class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                            {% else %}
                                <div class="flex items-center justify-center h-full text-gray-600 italic text-sm">
                                    <span>{% trans "No Preview" %}</span>
                                </div>
                            {% endif %}
                        </div>

                        <div class="p-3 flex items-start gap-3">

                            <div class="w-10 h-10 rounded-full bg-gray-700 border border-gray-600 flex-shrink-0 overflow-hidden">
                                {% if model.user.profile.image %}
                                    <img src="{{ model.user.profile.image.url }}" alt="{{ model.user.username }}"
                                         class="w-full h-full object-cover">
                                {% else %}
                                    <div class="flex items-center justify-center h-full text-[10px] text-gray-400 uppercase">
                                        {{ model.user.username|slice:":2" }}
                                    </div>
                                {% endif %}
                            </div>

                            <div class="flex-1 min-w-0">
                                <h3 class="text-sm font-bold text-white truncate leading-tight mb-0.5">
                                    {{ model.name }}
                                </h3>
                                <p class="text-xs text-gray-400 truncate">
                                    {{ model.user.username }}
                                </p>
                            </div>

                            <div class="flex flex-col items-end gap-1 flex-shrink-0">
                                <div class="flex gap-1">
                                    <div class="w-6 h-6 bg-gray-700 rounded flex items-center justify-center text-[10px] text-gray-300 border border-gray-600"
                                         title="Category: {{ model.category.name }}">
                                        <i class="fas fa-folder"></i>
                                    </div>
                                    <div class="px-1 min-w-[24px] h-6 bg-gray-700 rounded flex items-center justify-center text-[9px] font-bold text-green-400 border border-gray-600 uppercase">
                                        {{ model.model.name|slice:"-4:"|cut:"." }}
                                    </div>
                                </div>

                                <div class="flex gap-0.5 mt-1">
                                    <img src="{% static 'img/icons/star.svg' %}" class="w-2.5 h-2.5">
                                    <img src="{% static 'img/icons/star.svg' %}" class="w-2.5 h-2.5">
                                    <img src="{% static 'img/icons/star.svg' %}" class="w-2.5 h-2.5">
                                    <img src="{% static 'img/icons/star.svg' %}" class="w-2.5 h-2.5">
                                    <img src="{% static 'img/icons/star.svg' %}" class="w-2.5 h-2.5">
                                </div>
                            </div>
                        </div>
                    </div>
                </a>
                {% empty %}
                <div class="col-span-full text-center py-12 text-gray-500">
                    <p class="text-xl">{% trans 'No models found in this category.' %}</p>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}